<section class="cardstack-message-summary">
  <div class="cardstack-workflow-group">
    <h4 class="cardstack-workflow-group-header">Dashboards</h4>
    <div class={{concat "cardstack-workflow-label-with-count-wrapper " (if (eq selectedDate 'today') "active")}}>
      <div class="cardstack-workflow-label-with-count" onclick={{action 'selectDate' 'today'}}>
        <div class="name">Today</div>
        <div class="count" data-test-date-range-counter="Today">{{todaysMessageCount}}</div>
      </div>
    </div>
  </div>
  {{#each-in groupedMessages as |priority messagesWithPriority|}}
    <div class="cardstack-workflow-group">
      <h4 class="cardstack-workflow-group-header" data-test-priority-header={{priority}}>{{priority}}</h4>
      {{#each-in messagesWithPriority as |tag messagesAndCount|}}
        <div class={{concat "cardstack-workflow-label-with-count-wrapper " (if (eq selectedTag tag) "active")}}>
          <div class="cardstack-workflow-label-with-count"
              onclick={{action 'selectTag' tag}}>
            <div class='name'>{{tag}}</div>
            <div class="count" data-test-tag-counter={{tag}}>{{messagesAndCount.unhandledCount}}</div>
          </div>
        </div>
      {{/each-in}}
    </div>
  {{/each-in}}
</section>

{{#if selectedMessage}}
  <section class="cardstack-cue-card">
    {{cardstack-content content=selectedMessage format="card"}}
  </section>
{{else}}
  {{#if matchingMessages.length}}
    <section class="cardstack-cue-card-list">
      {{#each matchingMessages as |message|}}
        {{cardstack-content content=message format="list-card"}}
      {{/each}}
    </section>
  {{/if}}
{{/if}}