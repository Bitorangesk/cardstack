<section class="cardstack-message-summary">
  <div class="cardstack-workflow-group">
    <h4 class="cardstack-workflow-group-header">Dashboards</h4>
    <div class={{concat "cardstack-workflow-label-with-count-wrapper " (if (eq selectedDate 'today') "active")}}>
      <div class="cardstack-workflow-label-with-count high-priority" onclick={{action 'selectDate' 'today'}}>
        <div class="name">Today</div>
        <div class="count" data-test-group-counter="Today">{{todaysNotificationCount}}</div>
      </div>
    </div>
  </div>

  {{#each-in groupedThreads as |priorityId priorityGroup|}}
    {{#with priorityGroup.name as |name|}}
      <div class="cardstack-workflow-group" data-test-workflow-group={{name}}>
        <h4 class="cardstack-workflow-group-header" data-test-priority-header={{name}}>{{name}}</h4>
        {{#each-in priorityGroup.tagGroups as |tagId tagGroup|}}
          {{#with "fixme-group-id" as |groupId|}}
            <div class={{concat "cardstack-workflow-label-with-count-wrapper " (if (eq selectedGroup groupId) "active")}}>
              <div class={{concat "cardstack-workflow-label-with-count " tagGroup.priorityLevel "-priority"}} onclick={{action 'selectTag' tagId}}>
                <div class='name'>{{tagGroup.name}}</div>
                <div class="count" data-test-group-counter={{groupId}}>{{tagGroup.all.length}}</div>
              </div>
            </div>
          {{/with}}
        {{/each-in}}
      </div>
    {{/with}}
  {{/each-in}}
</section>

{{#if selectedThread}}
  <!-- TODO: Rename this to cardstack-thread-view -->
  <section class="cardstack-cue-card">
    {{cardstack/thread-container thread=selectedThread}}
  </section>
{{else}}
  {{#if shouldShowMatchingThreads}}
    <section class="cardstack-cue-card-list">
      {{#each-in matchingThreads as |priorityId priorityGroup|}}
        {{#with priorityGroup.name as |name|}}
          <h4 class="cardstack-workflow-group-header" data-test-priority-header={{name}}>{{name}}</h4>
          {{#each priorityGroup.threads as |thread|}}
            {{cardstack/thread-list-card thread=thread}}
          {{/each}}
        {{/with}}
      {{else}}
        {{!-- cardstack-content content=message format="empty-list-card" --}}
        <div class="cardstack-empty-cue-card-message" data-test-empty-group-message>
          There are no cards in this group.
        </div>
      {{/each-in}}
    </section>
  {{/if}}
{{/if}}